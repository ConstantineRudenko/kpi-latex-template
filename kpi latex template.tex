% allows using @ in macro
\makeatletter

% pt in MS Word is not equal to pt in LaTeX
% pt in MS Word is equal to bp in LaTeX 
% https://tex.stackexchange.com/questions/34024/setting-a-document-in-ms-word-12pt-12bp
% this will globally replace size of pt to match MS Word
\p@=1bp

% disallows using @ in macro
\makeatother

% article does not support 14pt
\documentclass[14pt]{extarticle}

%set margins and page format
% call geometry first so everything else uses set margins
\usepackage[a4paper, portrait, includefoot, left=3cm, right=2cm, top=2cm, bottom=2cm, footskip=14pt]{geometry}

\usepackage{fancyhdr}
\renewcommand{\headrulewidth}{0pt}
\renewcommand{\footrulewidth}{0pt}
\pagestyle{fancy}
\fancyhf{}
\rfoot{\thepage}

% set line spacing
\renewcommand{\baselinestretch}{1.5} 

% paragraph indentation
\setlength\parindent{1cm}

% allows using @ in macro
\makeatletter

% change bibliography item numbering style
\renewcommand\@biblabel[1]{#1.}

% dotted line for table of contents (vanilla, not needed with tocloft)
%\renewcommand*\l@section{\@dottedtocline{1}{0em}{1em}}

% disallows using @ in macro
\makeatother

% ignore font substitution warnings
% it's the default font being substituted with polyglossia fonts

% first section number
%\setcounter{section}{0}

% customize title format and spacing for section, subsection, etc.
\usepackage{titlesec}
% a flag for unnumbered sections
\newcommand{\issectionnumbered}{1}
\titleformat{\section}[block]{\bfseries\filcenter}{}{0em}{\if\issectionnumbered1\thesection. \fi}{}
\titleformat{\subsection}[block]{\bfseries}{}{0em}{\thesubsection. }{}
\titlespacing{\section}{0pt}{0pt}{0pt}
\titlespacing{\subsection}{0pt}{0pt}{0pt}

% custom command for unnumbered sections
\newcommand{\unnumberedsection}[1]{
\renewcommand{\issectionnumbered}{0}
\section*{#1}
\addcontentsline{toc}{section}{#1}
\renewcommand{\issectionnumbered}{1}
}

% customize table of contents
\usepackage{tocloft}
% use page style from fancyhdr for table of contents page (header/footer)
\tocloftpagestyle{fancy}
% section font in table of contents
\renewcommand\cftsecfont{\normalfont}
% section page number font in table of contents
\renewcommand\cftsecpagefont{\normalfont}
% dotted lines in table of contents
\renewcommand{\cftsecleader}{\cftdotfill{\cftdotsep}}
% dot after section number
\renewcommand{\cftsecaftersnum}{.}%
% dot after subsection number
\renewcommand{\cftsubsecaftersnum}{.}%
% center the title of table of contents
\renewcommand{\cfttoctitlefont}{\bfseries\hspace*{\fill}}
\renewcommand{\cftaftertoctitle}{\hspace*{\fill}}
% \hfill = hspace{\fill}
% use hspace*{\fill} instead
% hspace without asterisk sometimes drops spaces (like in the end of the line)
% hspace with asterisk always creates space

% don't skip vertical space before table of contents entries
\setlength\cftbeforesecskip{0pt}
\setlength\cftbeforesubsecskip{0pt}

% don't skip vertical spacebe before and after table of contents title
\setlength\cftbeforetoctitleskip{0pt}
\setlength\cftaftertoctitleskip{0pt}

\usepackage{cite}

\usepackage{indentfirst}

% font
% loaded by mathspec
% \usepackage{fontspec}

\usepackage{mathspec}
\setmathsfont(Digits,Latin,Greek)[Numbers={Lining,Proportional},SizeFeatures={Size=14}]{Cambria Math}
\newfontfamily\smalltimes{Times New Roman}[Script=Cyrillic,Ligatures=TeX,SizeFeatures={Size=8}]
\setmainfont{Times New Roman}[Script=Cyrillic,Ligatures=TeX,SizeFeatures={Size=14}]

\renewcommand{\textsubscript}[1]{$_{\smalltimes\text{#1}}$}
\renewcommand{\textsuperscript}[1]{$^{\smalltimes\text{#1}}$}

\usepackage{etoolbox}
% replace first call of \section* in \thebibliography with \unnumberedsection
\patchcmd{\thebibliography}{\section*}{\unnumberedsection}{}{}
% section starts at new page
% \pretocmd{\section}{\newpage}{}{}
% bottom vspace from figure is bigger due to line interval
% make it equal by adding some on top
\pretocmd{\figure}{\vspace{0.5cm}}{}{}

\usepackage{url}
%urls use same font as other text
\urlstyle{same}

%forbid automatic hyphenation
\usepackage[none]{hyphenat}
\sloppy

% load polyglossia in the end to prevent it's changes being overwritten
\usepackage{polyglossia}
\setmainlanguage{ukrainian}

% localization (overwrites polyglossia on purpose)
\renewcommand\contentsname{ЗМІСТ}
\renewcommand\refname{СПИСОК ВИКОРИСТАНИХ ЛІТЕРАТУРНИХ ДЖЕРЕЛ}

% command for generating a bunch of text
\usepackage{lipsum}

% images
\usepackage{graphicx}
%  captions
\usepackage{caption}
% declare dot as separator for caption label
\DeclareCaptionLabelSeparator{dot}{. }
% use dot as separator for caption label
\captionsetup{labelsep=dot}
% multiple images in one figure
\usepackage{subcaption}
% one line skip before and after figure
\setlength{\textfloatsep}{1cm}
\setlength{\intextsep}{1cm}
%caption alignment
\captionsetup[figure]{justification=centering, singlelinecheck=off}
\captionsetup[table]{justification=centering, singlelinecheck=off}

% count figures within section
% \usepackage{chngcntr}
% \counterwithin{table}{section}
% \counterwithin{figure}{section}
g
\begin{document}

\tableofcontents
\newpage

\vspace{1in}

\unnumberedsection{ВСТУП}

Текст вступу.

\section{РОЗДІЛ 1}
\subsection{Пункт 1}
Тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст тестовий текст.
\subsection{Пункт 2}
текст
\section{РОЗДІЛ 2}
\subsection{Пункт 1}
посилання \cite{bib1,bib3,bib4,bib5}
\subsection{Пункт 2}
текст

\begin{thebibliography}{9}
\bibitem{bib1} 
Посилання 1
\bibitem{bib2} 
Посилання 2
\bibitem{bib3} 
"English book"

\bibitem{bib4}
Посилання 4

\bibitem{bib5}
Посилання 5

\end{thebibliography}

\end{document}